define(["ol","handlebars","html!!mapPopup","html!!mapPopup2","html!!taskLine","highcharts","datatables","imagesloaded"],function(e,t,a,n,i){var s,o,r,d,c,l,p=[],u=[],m=function(){$("#map").height($(window).height()-132-40)},f=function(){if(!e)return void $toast.error("当前浏览器版本不支持地图显示!<br/>请使用chrome或ie8以上版本浏览器");m(),$(window).on("resize",m),$(window).on("slidebar",function(){s&&s.updateSize()});var a=e.proj.fromLonLat([parseFloat(116.39739),parseFloat(39.40886)]),i=e.control.defaults({attributionOptions:{collapsible:!1}}).extend([new e.control.MapOptPanel({elem:$("#tpl_mapLegend").get(0),className:"ol-mapLegend",data:{legend:[{url:"assets/img/map/new/ZQ_3.png",title:"中小河流水文站"},{url:"assets/img/map/new/ZQ_2.png",title:"山洪水文站"},{url:"assets/img/map/new/PP_4.png",title:"雨量基本站"},{url:"assets/img/map/new/PP_2.png",title:"山洪雨量站"},{url:"assets/img/map/new/ZG_1.png",title:"地下水站"},{url:"assets/img/map/new/ZZ_2.png",title:"山洪水位站"}]}}),new e.control.LayerCheckbox({name:"ol-cb-gis",value:!0,title:"显示GIS图层",handle:function(e,t,a){h()}}),new e.control.LayerCheckbox({name:"ol-cb-bmap",value:!0,title:"显示百度底图",handle:function(e,t,a){h()}}),new e.control.LayerCheckbox({name:"ol-cb-sitename",value:!1,title:"显示站点名称",handle:function(e,t,a){y()}})]);s=new e.Map({controls:i,target:"map",logo:!1,view:new e.View({center:a,zoom:7,minZoom:5})}),s.on("click",function(e){var t=s.forEachFeatureAtPixel(e.pixel,function(e,t){return e}),a=e.coordinate;t&&g(t,a)}),s.on("pointermove",function(a){var i=s.forEachFeatureAtPixel(a.pixel,function(e,t){return e});if(i){var o=i.get("data");if("warning"===o.pointType){var c=a.coordinate;d&&(d.remove(),d=void 0);var l={};if(!r){l=$.extend(l,o,{addvnm:($dict.getItem("addvcd","addvcd",o.addvcd)||{}).addvnm,serviceTypeName:($dict.getItem("serviceType","trueValue",o.serviceType)||{}).showValue,sttpName:($dict.getItem("stcdType","trueValue",o.sttp)||{}).showValue,repairName:($dict.getItem("maintainer","id",o.repairId)||{}).name,sendTime:o.sendTime?o.sendTime:"暂无数据",insertTime:o.insertTime?o.insertTime:"暂无数据",observationTime:o.observationTime?o.observationTime:"暂无数据",difference:o.difference||0===o.difference?o.difference+"小时":"从未上报",repairTime:moment(o.nowTime).diff(moment(o.dealTime),"hours")+"小时"}),d=$(t.compile(n)(l));var p=new e.Overlay({element:d.get(0),autoPan:!0,autoPanAnimation:{duration:250}});p.setPosition(c),s.addOverlay(p)}}else d&&(d.remove(),d=void 0)}else d&&(d.remove(),d=void 0)});var o;s.getView().on("change:resolution",function(e){o&&clearTimeout(o),o=setTimeout(function(){var e=$(".ol-cb-sitename").find("input");s.getView().getZoom()>9?e.iCheck("check"):e.iCheck("uncheck")},500)})},g=function(n,i){var o=n.get("data"),c=[];if("station"===o.pointType||"warning"===o.pointType){var l=o.stcd,p=o.serviceType;def=$api.get({loading:!1,url:$cfg.baseUrl+"/map/stationState",data:{serviceType:p,stcd:l}}),c.push(def)}$.when.apply($,c).done(function(n){if("total"===o.pointType){var c=o.addvcd;$("#c_addvcd").val(c).change()}else if("station"===o.pointType||"warning"===o.pointType||"people"===o.pointType){var l={};if("station"===o.pointType)l=$.extend(l,o,{addvnm:($dict.getItem("addvcd","addvcd",o.addvcd)||{}).addvnm,serviceTypeName:($dict.getItem("serviceType","trueValue",o.serviceType)||{}).showValue,sttpName:($dict.getItem("stcdType","trueValue",o.sttp)||{}).showValue,repairName:($dict.getItem("maintainer","id",o.repairId)||{}).name,datas:n.success?$.map(Object.keys(n.data||[]),function(e){var t=n.data[e];if(t&&0!==t)return{name:e,value:t}}):[]});else if("warning"===o.pointType)l=$.extend(l,o,{addvnm:($dict.getItem("addvcd","addvcd",o.addvcd)||{}).addvnm,serviceTypeName:($dict.getItem("serviceType","trueValue",o.serviceType)||{}).showValue,sttpName:($dict.getItem("stcdType","trueValue",o.sttp)||{}).showValue,repairName:($dict.getItem("maintainer","id",o.repairId)||{}).name,sendTime:o.sendTime?o.sendTime:"暂无数据",insertTime:o.insertTime?o.insertTime:"暂无数据",observationTime:o.observationTime?o.observationTime:"暂无数据",difference:o.difference||0===o.difference?o.difference+"小时":"从未上报",datas:n.success?$.map(Object.keys(n.data||[]),function(e){var t=n.data[e];if(t&&0!==t)return{name:e,value:t}}):[]});else if("people"===o.pointType){var p=$dict.getItems("addvcd","addvcd",o.addvcd.split(","));l=$.extend(l,o,{phone:o.phone?o.phone:"无",status:"无任务",addvnm:$.map(p,function(e){return e.addvnm})})}d&&(d.remove(),d=void 0),r&&(r.remove(),r=void 0),r=$(t.compile(a)(l)),r.on("click",".ol-popup-closer",function(){r&&(r.remove(),r=void 0)}),r.on("click",".btn-repeat",function(){var e=$.extend({},o);S("","",e,"","")}),r.on("click",".btn-alert",function(){var e=$.extend({},o);C("","",e,"","")}),r.on("click",".btn-history",function(){var e=$.extend({},o);N("","",e,"","")});var u=new e.Overlay({element:r.get(0),autoPan:!0,autoPanAnimation:{duration:250}});u.setPosition(i),s.addOverlay(u)}var m=e.proj.fromLonLat([o.longitude,o.latitude]);s.getView().setCenter(m)})},v=function(t,a){var n=[],i=$(".ol-cb-sitename").find("input").prop("checked"),s=t.get("data");if("station"===a){var o=new e.style.Text({offsetY:15,font:"10px 微软雅黑",text:s.stnm,fill:new e.style.Fill({color:"#f00"}),stroke:new e.style.Stroke({color:"#fff",width:3})}),r=new e.style.Icon({anchor:[.5,.5],scale:.7,src:"assets/img/map/new/"+s.sttp+"_"+s.serviceType+".png"});n.push(new e.style.Style({image:r,text:i?o:void 0,zIndex:1}))}else if("total"===a){var d=s.num,o=[new e.style.Text({offsetY:0,font:"10px 微软雅黑",text:d.toString(),fill:new e.style.Fill({color:"#fff"})}),new e.style.Text({offsetY:25,font:"10px 微软雅黑",text:s.addvnm,fill:new e.style.Fill({color:"#f00"}),stroke:new e.style.Stroke({color:"#fff",width:3})})],r=[];r[0]=s.isCountTotal?new e.style.Circle({radius:18,fill:new e.style.Fill({color:"#f4a52d"}),stroke:new e.style.Stroke({color:"#f4a52d",width:1})}):new e.style.Icon({anchor:[.5,.5],scale:.9,src:"assets/img/map/total-1.png"}),r[1]=s.isCountTotal?new e.style.Circle({radius:18,fill:new e.style.Fill({color:"#ff2000"}),stroke:new e.style.Stroke({color:"#ff2000",width:1})}):new e.style.Icon({anchor:[.5,.5],scale:.9,src:"assets/img/map/total-2.png"}),n.push(new e.style.Style({image:d>20?r[1]:r[0],text:o[0],zIndex:2})),n.push(new e.style.Style({text:o[1],zIndex:3}))}else if("warning"===a){var o=new e.style.Text({offsetY:15,font:"10px 微软雅黑",text:s.stnm,fill:new e.style.Fill({color:"#f00"}),stroke:new e.style.Stroke({color:"#fff",width:3})}),r=new e.style.Icon({anchor:[.5,.5],scale:.7,src:"assets/img/map/new/"+s.sttp+"_"+s.serviceType+".png"});n.push(new e.style.Style({image:r,text:i?o:void 0,zIndex:1}))}else if("people"===a){var r=[];r[0]=new e.style.Icon({anchor:[.5,1],scale:.8,src:"assets/img/map/p1.png"}),r[1]=new e.style.Icon({anchor:[.5,1],scale:.8,src:"assets/img/map/p2.png"}),r[2]=new e.style.Icon({anchor:[.5,1],scale:.8,src:"assets/img/map/p3.png"});var c=3;0===s.state&&(c=s.taskNo?2:1),n.push(new e.style.Style({image:r[c],zIndex:1}))}return n},h=function(){var t=!$(".ol-cb-gis").find("input").prop("checked"),a=!$(".ol-cb-bmap").find("input").prop("checked"),n=$(".ol-cb-view").find("input").prop("checked");if(s&&p&&p.length>0&&($.map(p,function(e){s.removeLayer(e)}),p=[]),!a){var i=new e.layer.Tile({source:$opt.getBmapOptions()});p.push(i),s&&s.addLayer(i)}if(!t){var o=$cfg.mapUrl,r=($(".ol-cb-view input").val(),"show:0,1,2,3,4,5,6,7,8,9,10,11");r=n||!a?"show:0,1,2,3,4,7,8,9,10,11":"show:0,1,2,3,4,5,7,8,9,10,11";var d=new e.source.TileArcGISRest({crossOrigin:!0,url:o,params:{LAYERS:r,VERSION:"1.1.1",layerDefs:""}}),c=new e.layer.Tile({zIndex:1,source:d});p.push(c),s&&s.addLayer(c)}},y=function(t){r&&(r.remove(),r=void 0),d&&(d.remove(),d=void 0);var a=$("#c_station").val()||"",n={type:"stinfo"},i=$api.get({loading:!1,url:$cfg.baseUrl+"/map/faultSite24",data:$opt.paramFilter(n)});$.when(i,$dict.get("station")).done(function(n,i){if(n.success){var r={};$.each(n.data,function(e,t){r[t.stionId]=t}),s&&(o&&s.removeLayer(o),$.each(u,function(e,t){s.removeOverlay(t)}),u=[]);var d=new e.source.Vector({});o=new e.layer.Vector({zIndex:2,visible:!0,source:d});var c=i;c=$.map(c,function(e){if(e.stionId.toString()===a)return e}),$.each(c,function(t,a){var n,i=r[a.stionId];i?(n=i,n.pointType="station",n.warning=!0):(n=a,n.pointType="station");var o=e.proj.fromLonLat([n.longitude,n.latitude]),c=new e.geom.Point(o),l=new e.Feature({data:n,geometry:c});d.addFeature(l),l.setId(n.stionId),l.setStyle(v(l,"station")),s.getView().setCenter(o),s.getView().setZoom(10)}),s&&s.addLayer(o),t&&t()}else $toast.warning(n.msg)})},w=function(){$dict.init({name:"priority",url:$cfg.baseUrl+"/OptionSelect/com-ssxt-op-priority/"}),$dict.init({name:"serviceType",url:$cfg.baseUrl+"/OptionSelect/com-ssxt-op-serviceType/"}),$dict.init({name:"addvcd",url:$cfg.baseUrl+"/addvcd/loadAll/"}),$dict.init({name:"device",url:$cfg.baseUrl+"/device/loadAll/"}),$dict.init({name:"station",url:$cfg.baseUrl+"/stinfo/loadAll/"}),$dict.init({name:"stcdType",url:$cfg.baseUrl+"/OptionSelect/com-ssxt-op-stcdType/"}),$dict.init({name:"maintainer",url:$cfg.baseUrl+"/users/loadAll/?isOperation=1"}),$dict.init({name:"statusCode",url:$cfg.baseUrl+"/OptionSelect/statusCode"})},b=function(){var e=[];def=$dict.initOptions({elem:"#c_station",dict:"station",propText:function(e){return e.stcd+" "+e.stnm},propId:"stionId",filter:function(e,t){var a=$.userData.addvcd;return"0000"===a.slice(-4)||"00"===a.slice(-2)&&e.addvcd.slice(0,-2)===a.slice(0,-2)||a===e.addvcd}}),e.push(def),e.push($dict.get("addvcd")),e.push($dict.get("serviceType")),e.push($dict.get("stcdType")),e.push($dict.get("maintainer")),$.when.apply($,e).done(function(){f(),h(),$("#b_refresh").on("click",function(){y(),O()})})},T=function(e){var t=$("#c_station").val(),a=$dict.getItem("station","stionId",t),n=a.stcd,i=$api.get({loading:!1,url:$cfg.baseUrl+"/stinfo/stcdImage/"+n});$.when(i).done(function(t){if(e.trigger("loading.hide"),t.success){var a="";$cfg.picUrl&&$.each(t.data,function(e,t){t.url=$cfg.picUrl+t.url}),$.each(t.data,function(e,t){a+='<li><div class="col-md-12"><img src="'+t.url+'"></div></li>'}),e.find(".picture-list").html(a)}else $toast.warning(t.msg)}).fail(function(t){e.trigger("loading.hide"),$toast.error(t)})},x=function(e){c&&c.fnDestroy();var t=$.extend({},$plugin.datatable_server,{iDisplayLength:5,fnServerData:function(t,a,n){var i=$("#c_station").val(),s=$api.get({loading:!1,url:$cfg.baseUrl+"/stinfo/historyRecord/"+i});$.when(s).done(function(t){e.trigger("loading.hide"),t.success?n($opt.dataConvert(t)):$toast.warning(t.msg)}).fail(function(t){e.trigger("loading.hide"),$toast.error(t)})},aaSorting:[[0,"desc"]],ordering:!1,autoWidth:!1,info:"",columns:[{title:"使用人",data:"name",class:"text-center"},{title:"使用时间",data:"modifyTime",class:"text-center",render:function(e,t,a){return moment(e).format("YYYY-MM-DD")}},{title:"设备类型",data:"typeName",class:"text-center"},{title:"型号",data:"model",class:"text-center"},{title:"数量",data:"num",class:"text-center"}]});c=e.find(".table").dataTable(t)},I=function(e){var t=$api.get({loading:!1,url:$cfg.baseUrl+"/maintGps/distance/",data:{stionId:e.stionId}});$.when(t).done(function(t){if(t.success){var a=$.map(t.data,function(t){if(t.id===e.repairId)return $.extend({type:"自动指派",state:t.state,taskNo:t.taskNo},$dict.getItem("maintainer","id",t.id))}),n=[],i=[];$.each(t.data,function(e,t){1===t.exist&&t.distance<10?n.push($.extend({type:"距故障站<10km",state:t.state,taskNo:t.taskNo},$dict.getItem("maintainer","id",t.id))):i.push($.extend({type:"其他",state:t.state,taskNo:t.taskNo},$dict.getItem("maintainer","id",t.id)))}),$dict.add("gps_maint",a.concat(n).concat(i)),$dict.initOptions({s2s:"user",elem:"#p_maintUserId",dict:"gps_maint",propText:"name",propId:"id",templateResult:function(e){if(e.data){var t=3;0===e.data.state&&(t=e.data.taskNo?2:1);var a='<span class="select2-results-item"><img src="assets/img/map/p'+t+'.png"><b>'+e.text+"</b></span>";return $(a).get(0)}return e.text},propData:function(e){return e}}),$("#p_maintUserId").val(e.maintUserId).change()}else $toast.warning(t.msg)}).fail(function(e){$toast.error(e)})},k={},_={ignore:".ignore",errorPlacement:function(e,t){e.appendTo(t.parents(".form-group"))},rules:{priorityStatus:{required:!0}},messages:{priorityStatus:{required:"请选择优先级"}}},S=function(e,t,a,n,i){var s=$msg.dialog("manualAdd",function(e,t){return $(t).find("form").submit(),!1},{title:"新增报修单"});$.when(s).then(function(e){var t=e.find("form");F(function(){t.formData($.extend({},k,a)),$.updateTextFields();var n=$.extend({},_,{submitHandler:function(n){var i={},s=t.formData();$.extend(i,s,{stionId:a.stionId,taskStatus:"-1"!==s.maintUserId?10:"-1"});var o=$api.post({url:$cfg.baseUrl+"/task/addTask",data:$opt.paramFilter(i)});$.when(o).done(function(t){t.success?($toast.success(t.msg),e.modal("hide"),$("#b_refresh").trigger("click")):$toast.warning(t.msg)}).fail(function(e){$toast.error(e)})}});t.validate(n),t.formDisable(!1),$("#p_stcd").attr("disabled","true"),$("#p_stnm").attr("disabled","true"),I(a)})})},C=function(e,t,a,n,i){var s=$api.post({loading:!1,url:$cfg.baseUrl+"/message/addUpdate",data:{message:"[报修提醒]你有新的任务单"+a.stnm+"测站24小时未上报",type:1,state:0,taskNo:a.taskNo,level:2}});$.when(s).done(function(e){e.success?$toast.success("提醒成功！"):$toast.warning(e.msg)}).fail(function(e){$toast.error(e)})},N=function(e,t,a,n,i){var s=$msg.dialog("historyAdd",function(e,t){return!0},{title:"站点历史维修单",modalClassName:"modal-lg",buttons:{success:{label:"确定",className:"btn-info"}}});$.when(s).then(function(e){l&&l.fnDestroy();var t=$.extend({},$plugin.datatable_server,{fnServerData:function(e,t,n){var i=$.extend({},$opt.paramConvert(t),$opt.paramFilter({stionId:a.stionId,taskStatus:60})),s=$api.get({url:$cfg.baseUrl+"/task/history",data:i});$.when(s).done(function(e){e.success?n($opt.dataConvert(e)):$toast.warning(e.msg)}).fail(function(e){$toast.error(e)})},aaSorting:[[0,"desc"]],columns:[{title:"测站名称",data:"stionId",class:"text-center",fnCreatedCell:function(e,t,a,n,i){$dict.get("station").then(function(a){$.each(a,function(a,n){n.stionId===t&&$(e).html(n.stnm)})})}},{title:"维修区域",data:"addvcd",class:"text-center",fnCreatedCell:function(e,t,a,n,i){$dict.get("addvcd").then(function(a){$.each(a,function(a,n){n.addvcd===t&&$(e).html(n.addvnm)})})}},{title:"创建时间",data:"createTime",class:"text-center"},{title:"响应/修复",data:"taskStatus",class:"text-center",fnCreatedCell:function(e,t,a,n,i){var s="",o=moment(a.reciveTime).diff(moment(a.createTime),"hours"),r=moment(a.finishTime).diff(moment(a.dealTime),"hours");s+=t>10?'<div>响应<span class="text-red">'+o+"</span>小时</div>\n":"<div>未响应</div>\n",s+=t>30?'<div>修复<span class="text-red">'+r+"</span>小时</div>":"<div>未修复</div>",$(e).html(s)}},{title:"状态",data:"taskStatus",class:"text-center",fnCreatedCell:function(e,t,a,n,i){var s={0:"mt-5 badge bg-red",10:"mt-5 badge bg-dutch",20:"mt-5 badge bg-blue",30:"mt-5 badge bg-orange",40:"mt-5 badge bg-amethyst",50:"mt-5 badge bg-red",60:"mt-5 badge bg-green"};$dict.get("statusCode").then(function(a){$.each(a,function(a,n){n.value===t&&$(e).html('<div class="'+s[n.value]+'">'+n.name+"</div>")})})}},{title:"维修人员",data:"maintUserId",class:"text-center",fnCreatedCell:function(e,t,a,n,i){$(e).html(""),$dict.get("maintainer").then(function(a){$.each(a,function(a,n){n.id===t&&$(e).html(n.name)})})}},{title:"联系电话",data:"maintUserId",class:"text-center",fnCreatedCell:function(e,t,a,n,i){$dict.get("maintainer").then(function(a){var n="";$.each(a,function(e,a){a.id===t&&a.phone&&(n='<a><i class="fa fa-phone-square text-success ml-5"></i> '+a.phone+"</a>")}),$(e).html(n)})}},{title:"操作",data:"taskStatus",bSortable:!1,fnCreatedCell:function(e,t,a,n,i){var s=$('<a class="btn btn-info btn-xs ml-5"><i class="fa fa-file-o"></i>详情</a>');s.on("click",function(){U(e,t,a,n,i)}),$(e).html("").append(s)}}]});l=$(e).find(".table").dataTable(t)})},U=function(e,a,n,s,o){var r=$msg.dialog("taskInfo",function(e,t){return!1},{title:"维修单详情",modalClassName:"modal-lg",buttons:{success:{label:"确定",className:"btn-info"}}}),d=$api.get({loading:!1,url:$cfg.baseUrl+"/task/load/"+n.taskNo});$.when(r,d,$dict.get("station")).then(function(e,a){if(a.success){var s=e.find("form.info-left"),o=e.find("form.info-right"),r=-1,d=function(){var a=$api.get({loading:!1,url:$cfg.baseUrl+"/taskProcess/loadAll/"+n.taskNo});$.when(a).done(function(a){if(a.success){a&&a.data&&a.data.length>0&&(r=a.data[a.data.length-1].id);var n=o.find(".task-timeline");$cfg.picUrl&&$.each(a.data,function(e,t){$.each(t.basTaskDealNodes,function(e,t){t.url=$cfg.picUrl+t.url})});var d=t.compile(i)(a);n.html(d),n.imagesLoaded(function(){s.height(Math.max(s.height(),o.height())),e.resize()})}else $toast.warning(a.msg),e.modal("hide")}).fail(function(e){$toast.error(e)})};F(function(){var e=$dict.getItem("station","stionId",a.data.stionId);s.formData($.extend({},k,a.data,{serviceType:e.serviceType,stcd:e.stcd,helpPersonnel:(a.data.helpPersonnel||"").split(","),stnm:e.stnm})),$.updateTextFields(),s.formDisable(!1),$("#p_taskNo").attr("disabled","true"),$("#p_taskStatus").attr("disabled","true"),$("#p_stcd").attr("disabled","true"),$("#p_stnm").attr("disabled","true"),$("#p_serviceType").attr("disabled","true"),$("#p_addvcd").attr("disabled","true"),$("#p_content").attr("disabled","true"),$("#p_priorityStatus").attr("disabled","true"),$("#p_createTime").attr("disabled","true"),$("#p_maintUserId").attr("disabled","true"),$("#p_helpPersonnel").attr("disabled","true");var t={ignore:".ignore",errorPlacement:function(e,t){e.appendTo(t.parents(".form-group"))},rules:{content:{required:!0}},messages:{content:{required:"内容不能为空"}}},i=$.extend({},t,{submitHandler:function(e){var t={},a=o.formData();$.extend(t,a,{taskNo:n.taskNo,dealType:1,procId:r});var i=$api.post({url:$cfg.baseUrl+"/taskDealNode/addJournal",data:$opt.paramFilter(t)});$.when(i).done(function(e){e.success?($toast.success(e.msg),o.get(0).reset(),d()):$toast.warning(e.msg)}).fail(function(e){$toast.error(e)})}});o.validate(i),d()})}else $toast.warning(a.msg),e.modal("hide")})},F=function(e){var t,a=[];t=$dict.initOptions({elem:"#p_maintUserId",dict:"maintainer",propText:"name",propId:"id",append:[{id:"-1",text:"未指派"}]}),a.push(t),t=$dict.initOptions({elem:"#p_helpPersonnel",dict:"maintainer",propText:"name",propId:"id"}),a.push(t),t=$dict.initOptions({elem:"#p_priorityStatus",dict:"priority",propText:"showValue",propId:"trueValue"}),a.push(t),t=$dict.initOptions({s2s:!0,elem:"#p_addvcd",dict:"addvcd",propText:"addvnm",propId:"addvcd",filter:function(e,t){var a=$.userData.addvcd;return"0000"===a.slice(-4)||"00"===a.slice(-2)&&e.addvcd.slice(0,-2)===a.slice(0,-2)||a===e.addvcd}}),a.push(t),t=$dict.initOptions({elem:"#p_taskStatus",dict:"statusCode",propText:"name",propId:"value"}),a.push(t),t=$dict.initOptions({elem:"#p_serviceType",dict:"serviceType",propText:"showValue",propId:"trueValue"}),a.push(t),$.when.apply($,a).done(function(){$.isFunction(e)&&e()})},O=function(){var e=[{elem:$("#p_panel_2").get(0),data:{title:"备件更换历史记录"},initFunc:x},{elem:$("#p_panel_1").get(0),data:{title:"站点周边环境"},initFunc:T}],a=$(".slidebar-content");a.html(""),$.map(e,function(e){var n=e.html||e.elem.innerHTML.replace(/\[\[/g,"{{").replace(/]]/g,"}}"),i=t.compile(n)(e.data||{}),s=$(i);s.on("refresh",function(){$.isFunction(e.initFunc)&&(s.trigger("loading.show"),e.initFunc.apply(e,[s]))}),a.append(s),$.isFunction(e.initFunc)&&(e.attach=!1,e.initFunc.apply(e,[s]))})};return{data:{model:[{icon:"fa fa-server",title:"运维助理"},{icon:"",title:"站点查询"}]},init:function(e){console.log(e+":init"),w(),b()},dispose:function(e){console.log(e+":dispose")}}});