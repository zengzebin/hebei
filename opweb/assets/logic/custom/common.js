define(["handlebars","ol","js-cookie","toastr","bootbox","moment","bowser","jquery-nicescroll","jquery-validation","jquery-md5"],function(e,t,n,o,a,r,i){function s(){return document.scrollTop||document.documentElement.scrollTop||document.body.scrollTop}function l(){return window.innerHeight||document.documentElement.clientHeight}function c(){var e=$(".btn-scroll-up");if(e.length>0){var t=!1;$(window).on("scroll.scroll_btn",function(){var n=s(),o=l(),a=document.body.scrollHeight;n>parseInt(o/4)||n>0&&a>=o&&o+n>=a-1?t||(e.addClass("display"),t=!0):t&&(e.removeClass("display"),t=!1)}).triggerHandler("scroll.scroll_btn"),e.on("click",function(){var e=Math.min(500,Math.max(100,parseInt(s()/3)));return $("html,body").animate({scrollTop:0},e),!1})}}function d(){if(!t)return void u.error("当前浏览器版本不支持地图显示!<br/>请使用chrome或ie8以上版本浏览器");t.control.LayerSwitcher=function(e){var n=e||{},o=$("<div></div>"),a=$('<input type="checkbox" class="js-switch"/>');n.value&&(a=$('<input type="checkbox" class="js-switch" checked/>'));var r=this,i=function(e){$.isFunction(n.handle)&&n.handle.call(r,e,r.getMap(),o)};a.on("change",i),o.addClass(n.name+" ol-unselectable ol-control"),o.append(a),t.control.Control.call(this,{element:o.get(0),target:n.target}),setTimeout(function(){a.switchery({size:"small",color:"#79d4a7",secondaryColor:"#e8e8e8"}),a.next(".switchery").attr("data-toggle","tooltip").attr("title",n.title).tooltip()},100)},t.inherits(t.control.LayerSwitcher,t.control.Control),t.control.LayerCheckbox=function(e){var n=e||{},o=$("<div></div>"),a=$('<label><input type="checkbox"><b class="ml-5">'+n.title+"</b></label>");n.value&&(a=$('<label><input type="checkbox" checked><b class="ml-5">'+n.title+"</b></label>"));var r=this,i=function(e){$.isFunction(n.handle)&&n.handle.call(r,e,r.getMap(),o)};a.on("ifChanged",i),o.addClass(n.name+" ol-unselectable ol-control"),o.append(a),t.control.Control.call(this,{element:o.get(0),target:n.target}),setTimeout(function(){a.iCheck({checkboxClass:"icheckbox_minimal-red",radioClass:"iradio_minimal-red",labelHover:!1,cursor:!0})},100)},t.inherits(t.control.LayerCheckbox,t.control.Control),t.control.MapTitle=function(e){var n=$.extend({title:"",subtitle:""},e),o=$("<div></div>");o.addClass("ol-maptitle ol-unselectable ol-control"),o.append($('<span class="title">'+n.title+'</span><span class="subtitle">'+n.subtitle+"</span>")),t.control.Control.call(this,{element:o.get(0),target:n.target})},t.inherits(t.control.MapTitle,t.control.Control),t.control.MapOptPanel=function(n){var o=$.extend({},n),a=$("<div></div>");a.addClass(o.className+" ol-unselectable ol-control");var r=o.html||o.elem.innerHTML.replace(/\[\[/g,"{{").replace(/]]/g,"}}"),i=e.compile(r)(o.data||{});a.html(i),t.control.Control.call(this,{element:a.get(0),target:o.target})},t.inherits(t.control.MapOptPanel,t.control.Control)}window.Cookies=n,window.moment=r,jQuery.validator.addMethod("integer",function(e,t,n){return this.optional(t)||isInteger(e)&&e>=0}),jQuery.validator.addMethod("chinese",function(e,t,n){var o=new RegExp(".*[\\u4e00-\\u9fa5]+.*$");return this.optional(t)||!o.test(e)}),jQuery.validator.addMethod("startTime",function(e,t,n){var o=e,a=$(n).val(),i=!1;return a&&r(a).format("X")<r(o).format("X")&&(i=!0),this.optional(t)||!i}),jQuery.validator.addMethod("endTime",function(e,t,n){var o=$(n).val(),a=e,i=!1;return o&&r(a).format("X")<r(o).format("X")&&(i=!0),this.optional(t)||!i}),jQuery.validator.addMethod("unequalTo",function(e,t,n){var o=$(n).val(),a=!1;return o&&o==e&&(a=!0),this.optional(t)||!a});var u=function(){return{info:function(e,t){if(o){var n=$.extend({positionClass:"toast-top-right",extendedTimeOut:0,timeOut:5e3,closeButton:!0,iconClass:"toast-info"},t);o.info(e,n.title||"提示",n)}else console.log("当前页面未导入toastr脚本")},warning:function(e,t){if(o){var n=$.extend({positionClass:"toast-top-right",extendedTimeOut:0,timeOut:5e3,closeButton:!0,iconClass:"toast-warning"},t);o.warning(e,n.title||"警告",n)}else console.log("当前页面未导入toastr脚本")},error:function(e,t){if(o){var n=$.extend({positionClass:"toast-top-right",extendedTimeOut:0,timeOut:5e3,closeButton:!0,iconClass:"toast-error"},t);o.error(e,n.title||"错误",n)}else console.log("当前页面未导入toastr脚本")},success:function(e,t){if(o){var n=$.extend({positionClass:"toast-top-right",extendedTimeOut:0,timeOut:5e3,closeButton:!0,iconClass:"toast-success"},t);o.success(e,n.title||"完成",n)}else console.log("当前页面未导入toastr脚本")},show:function(e,t,n,a){if(o){var r=$.extend({type:"custom",positionClass:"toast-top-right",extendedTimeOut:0,timeOut:5e3,closeButton:!0,iconClass:(t||"fa-exclamation-circle")+" toast-"+(n||"blue")},a);o.info(e,r.title||"",r)}else console.log("当前页面未导入toastr脚本")}}}();window.$toast=u;var f=function(){return{info:function(e,t){var n;if(a){var o={message:"<h3>提示</h3>"+e,title:'<i class="fa fa-envelope"></i>',className:"modal-message modal-info",closeButton:!1,buttons:{success:{label:"确定",className:"btn-info",callback:function(){}}}};$.extend(o,t),n=a.dialog(o),n.resize=function(){var e=$(this).find(".modal-content").height(),t=$(window).height()/2-e/2;t>0&&$(this).find(".modal-dialog").animate({marginTop:t},100)},n.on("shown.bs.modal",function(e){n.resize()})}else console.log("当前页面未导入bootbox脚本");return n},warning:function(e,t){var n;if(a){var o={message:"<h3>警告</h3>"+e,title:'<i class="fa fa-warning"></i>',className:"modal-message modal-warning",closeButton:!1,buttons:{success:{label:"确定",className:"btn-warning",callback:function(){}}}};$.extend(o,t),n=a.dialog(o),n.resize=function(){var e=$(this).find(".modal-content").height(),t=$(window).height()/2-e/2;t>0&&$(this).find(".modal-dialog").animate({marginTop:t},100)},n.on("shown.bs.modal",function(e){n.resize()})}else console.log("当前页面未导入bootbox脚本");return n},success:function(e,t){var n;if(a){var o={message:"<h3>完成</h3>"+e,title:'<i class="fa fa-bell"></i>',className:"modal-message modal-success",closeButton:!1,buttons:{success:{label:"确定",className:"btn-success",callback:function(){}}}};$.extend(o,t),n=a.dialog(o),n.resize=function(){var e=$(this).find(".modal-content").height(),t=$(window).height()/2-e/2;t>0&&$(this).find(".modal-dialog").animate({marginTop:t},100)},n.on("shown.bs.modal",function(e){n.resize()})}else console.log("当前页面未导入bootbox脚本");return n},error:function(e,t){var n;if(a){var o={message:"<h3>错误</h3>"+e,title:'<i class="glyphicon glyphicon-fire"></i>',className:"modal-message modal-danger",closeButton:!1,buttons:{success:{label:"确定",className:"btn-danger",callback:function(){}}}};$.extend(o,t),n=a.dialog(o),n.resize=function(){var e=$(this).find(".modal-content").height(),t=$(window).height()/2-e/2;t>0&&$(this).find(".modal-dialog").animate({marginTop:t},100)},n.on("shown.bs.modal",function(e){n.resize()})}else console.log("当前页面未导入bootbox脚本");return n},confirm:function(e,t,n){var o;if(a){var r={message:"<h3>确定</h3>"+e,title:'<i class="fa fa-exclamation-circle"></i>',className:"modal-message modal-info",closeButton:!1,buttons:{success:{label:"确定",className:"btn-info",callback:t},cancle:{label:"取消",className:"btn-default",callback:function(){}}}};$.extend(r,n),o=a.dialog(r),o.resize=function(){var e=$(this).find(".modal-content").height(),t=$(window).height()/2-e/2;t>0&&$(this).find(".modal-dialog").animate({marginTop:t},100)},o.on("shown.bs.modal",function(e){o.resize()})}else console.log("当前页面未导入bootbox脚本");return o},dialog:function(t,n,o){var r,i=$.Deferred(),s=function(t){if(a){var s={message:e.compile(t)(o.data||{}),className:"",title:"操作框",closeButton:!0,onEscape:function(){},buttons:{success:{label:"确定",className:"btn-info",callback:function(e){return $.isFunction(n)&&n.call(this,e,r)}},cancle:{label:"取消",className:"btn-default",callback:function(){}}}};$.extend(s,o),r=a.dialog(s),r.resize=function(){s.modalClassName&&$(this).find(".modal-dialog").addClass(s.modalClassName);var e=$(window).height();$(this).find(".modal-body").css("overflowX","auto").css("maxHeight",e-200+"px").niceScroll({styler:"fb",cursorcolor:"#509fed",cursorwidth:"6",cursorborderradius:"15px",background:"#404040",cursorborder:"",zindex:"9990"});var t=$(this).find(".modal-content").height(),n=e/2-t/2;n>0&&$(this).find(".modal-dialog").animate({marginTop:n},100)},r.on("shown.bs.modal",function(e){$(document).off("focusin.modal"),r.resize(),i.resolve(r),y(r)})}else console.log("当前页面未导入bootbox脚本"),i.reject("当前页面未导入bootbox脚本")};return require(["html!!"+t],function(e){s(e)},function(){$.get("error-404.html",function(e){s(e.match(/<body>[\s\S]*<\/body>/))}),i.reject("页面加载失败")}),i.promise()}}}();window.$msg=f;var h=function(){return{datatable_server:{bServerSide:!0,bFilter:!1,bLengthChange:!1,bAutoWidth:!1,iDisplayLength:15,language:{loadingRecords:"加载中...",processing:"正在加载中...",lengthMenu:"每页 _MENU_ 条记录",zeroRecords:"没有找到记录",info:"当前 _START_ 到 _END_ 条记录（共 _TOTAL_ 条）",infoEmpty:"当前 0 条记录",infoFiltered:"（从 _MAX_ 条记录筛查出）",infoPostFix:"",url:"",search:"",oPaginate:{sFirst:"首页",sPrevious:"上一页",sNext:"下一页",sLast:"尾页"}}},datatable_local:{bFilter:!1,bLengthChange:!1,bAutoWidth:!1,iDisplayLength:15,language:{loadingRecords:"加载中...",processing:"正在加载中...",lengthMenu:"每页 _MENU_ 条记录",zeroRecords:"没有找到记录",info:"当前 _START_ 到 _END_ 条记录（共 _TOTAL_ 条）",infoEmpty:"当前 0 条记录",infoFiltered:"（从 _MAX_ 条记录筛查出）",infoPostFix:"",url:"",search:"",oPaginate:{sFirst:"首页",sPrevious:"上一页",sNext:"下一页",sLast:"尾页"}}}}}();window.$plugin=h;var m=function(){var e=$.extend({},window.jsonConfig);return"proxy"===e.mockMod?e.baseUrl="/opapi/api":"mock"===e.mockMod&&(e.baseUrl="/opapi/api"),e}();window.$cfg=m;var p=function(){function e(e){var t;if("proxy"===m.mockMod||"mock"===m.mockMod){var n,o=e.type.toLocaleLowerCase();n="put"===o||"post"===o?{query:{},params:{},body:e.data||{},fields:{},files:{}}:{query:e.data||{},params:{},body:{},fields:{},files:{}};var a=$.md5(JSON.stringify(i(n)));t={url:"assets/"+m.mockMod+"/"+e.url+"/"+o+"_"+a+".json",type:"GET"},delete e.url,delete e.type}else t={url:m.baseUrl+e.sUrl,type:"GET"};return t}function t(t){var n=$.Deferred(),o=$.extend({crossDomain:!0,xhrFields:{withCredentials:!0},dataType:"json",contentType:"POST"===t.type||"PUT"===t.type?void 0:"application/json;charset=UTF-8"},e(t),t);return!1!==o.loading&&$(".mask").removeClass("hide"),$.ajax(o).done(function(e){n.resolve(e),!1!==o.loading&&$(".mask").addClass("hide")}).fail(function(e){var t=e.responseText||"";t.indexOf("<body>")>-1&&(t=t.match(/<body>[\s\S]*<\/body>/)),n.reject(t||e.statusText),!1!==o.loading&&$(".mask").addClass("hide")}),n}function n(e){return e.type="GET",t(e)}function o(e){return e.type="POST",t(e)}function a(e){return e.type="PUT",t(e)}function r(e){return e.type="DELETE",t(e)}$.support.cors=!0;var i=function(e){var t={},n=Object.keys(e);n.sort(function(e,t){return e>t?1:-1});for(var o=0;o<n.length;o++){var a=n[o],r=e[a];t[a]=r&&"object"==typeof r?i(r):r.toString()}return t};return{loadXML:function(e){var t;if(window.ActiveXObject)t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.load(e);else if(isFirefox=navigator.userAgent.indexOf("Firefox")>0)t=document.implementation.createDocument("","",null),t.load(e);else{var n=new window.XMLHttpRequest;n.open("GET",e,!1),n.send(null),4===n.readyState&&(t=n.responseXML.documentElement)}return t},ajax:t,get:n,post:o,put:a,del:r}}();window.$api=p;var v=function(){var e={},t=[],n={};return{cfg:function(){return t},all:function(){return e},getItem:function(t,n,o){null===o&&(o="");var a=$.map(e[t],function(e){if(e[n].toString()===o.toString())return e});return a.length>0?a[0]:void 0},getItems:function(t,n,o){return isArray(o)?$.map(e[t],function(e){if(o.indexOf(e[n].toString())>-1)return e}):$.map(e[t],function(e){if(e[n].toString()===o.toString())return e})},get:function(o){var a=t[o];if(!a)return void u.error("字典"+o+"缺少配置项");var r;if(n[o]&&"rejected"!==n[o].state())r=n[o];else{r=$.Deferred(),n[o]=r;var i=p.get({url:a.url});$.when(i).done(function(t){t.success?(e[o]=t.data||[],r.resolve(e[o])):(r.reject(),delete n[o],u.warning("字典"+o+"加载失败"))}).fail(function(){r.reject(),delete n[o],u.error("字典"+o+"加载失败")})}return r.promise()},add:function(o,a){e[o]=a,n[o]=$.Deferred().resolve(),t[o]=!0},remove:function(t){delete e[t],delete n[t]},init:function(e){t[e.name]=e},initOptions:function(e,t){var n=$.Deferred(),o=function(e){$(e.elem).html(""),$(e.elem).hasClass("select2-hidden-accessible")&&$(e.elem).width($(e.elem).removeClass("select2-hidden-accessible").next(".select2").width()),e.s2s?$(e.elem).select2s({templateResult:e.templateResult,s2s:e.s2s,data:v.optionsData(e),minimumResultsForSearch:e.search||0,placeholder:e.placeholder||"请选择",allowClear:e.clear,language:"zh_CN"}):$(e.elem).select2({templateResult:e.templateResult,data:v.optionsData(e),minimumResultsForSearch:e.search||0,placeholder:e.placeholder||"请选择",allowClear:e.clear,language:"zh_CN"}),e.callback&&e.callback()};return t?(o(e),n.resolve()):$.when(v.get(e.dict)).done(function(){o(e),n.resolve()}).fail(function(){n.reject()}),n.promise()},optionsData:function(t){var n=$.map(e[t.dict],function(e,n){var o={id:$.isFunction(t.propId)?t.propId.call(this,e):e[t.propId],text:$.isFunction(t.propText)?t.propText.call(this,e):e[t.propText],data:$.isFunction(t.propData)?t.propData.call(this,e):e[t.propData]};if(!$.isFunction(t.filter)||$.isFunction(t.filter)&&t.filter.call(this,e,o))return o});return(t.append||[]).concat(n)}}}();window.$dict=v;var g=function(){return{getBmapOptions:function(){function e(e,t,n){return e=Math.max(e,t),e=Math.min(e,n)}function n(e,t,n){for(var o=n-t;e>n;)e-=o;for(;e<t;)e+=o;return e}function o(e,t,n,o){var a=e[n],r=e[n+1],i=o[0]+o[1]*Math.abs(a),s=Math.abs(r)/o[9],l=o[2]+o[3]*s+o[4]*s*s+o[5]*s*s*s+o[6]*s*s*s*s+o[7]*s*s*s*s*s+o[8]*s*s*s*s*s*s;t[n]=i*(a<0?-1:1),t[n+1]=l*(r<0?-1:1)}function a(e,t){var n=i(e-105,t-35),o=s(e-105,t-35),a=t/180*w,r=Math.sin(a);r=1-y*r*r;var l=Math.sqrt(r);return n=180*n/(x*(1-y)/(r*l)*w),o=180*o/(x/l*Math.cos(a)*w),[o,n]}function r(e,t){return e<72.004||e>137.8347||(t<.8293||t>55.8271)}function i(e,t){var n=2*e-100+3*t+.2*t*t+.1*e*t+.2*Math.sqrt(Math.abs(e));return n+=2*(20*Math.sin(6*e*w)+20*Math.sin(2*e*w))/3,n+=2*(20*Math.sin(t*w)+40*Math.sin(t/3*w))/3,n+=2*(160*Math.sin(t/12*w)+320*Math.sin(t*w/30))/3}function s(e,t){var n=300+e+2*t+.1*e*e+.1*e*t+.1*Math.sqrt(Math.abs(e));return n+=2*(20*Math.sin(6*e*w)+20*Math.sin(2*e*w))/3,n+=2*(20*Math.sin(e*w)+40*Math.sin(e/3*w))/3,n+=2*(150*Math.sin(e/12*w)+300*Math.sin(e/30*w))/3}function l(e,t,n){var o=e[n]-.0065,a=e[n+1]-.006,r=Math.sqrt(o*o+a*a)-2e-5*Math.sin(a*C),i=Math.atan2(a,o)-3e-6*Math.cos(o*C);return t[n]=r*Math.cos(i),t[n+1]=r*Math.sin(i),t}function c(e,t,n){var o=e[n],a=e[n+1],r=Math.sqrt(o*o+a*a)+2e-5*Math.sin(a*C),i=Math.atan2(a,o)+3e-6*Math.cos(o*C);return t[n]=r*Math.cos(i)+.0065,t[n+1]=r*Math.sin(i)+.006,t}var d=function(e){return function(t,n,o){var a,r=t.length,i=o||2;a=n||(2!==i?t.slice():new Array(r));for(var s=0;s<r;s+=i)e(t,a,s);return a}},u={},f=Math.PI/180;u.forward=d(function(e,t,n){var o=Math.max(Math.min(85.0511287798,e[n+1]),-85.0511287798),a=Math.sin(o*f);t[n]=6378137*e[n]*f,t[n+1]=6378137*Math.log((1+a)/(1-a))/2}),u.inverse=d(function(e,t,n){t[n]=e[n]/6378137/f,t[n+1]=(2*Math.atan(Math.exp(e[n+1]/6378137))-Math.PI/2)/f});var h={},p=[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],v=[75,60,45,30,15,0],g=[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],b=[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]];h.forward=d(function(t,a,r){var i,s=n(t[r],-180,180),l=e(t[r+1],-74,74),c=null;for(i=0;i<v.length;++i)if(l>=v[i]){c=b[i];break}if(null===c)for(i=v.length-1;i>=0;--i)if(l<=-v[i]){c=b[i];break}a[r]=s,a[r+1]=l,o(a,a,r,c)}),h.inverse=d(function(e,t,n){for(var a=Math.abs(e[n+1]),r=null,i=0;i<p.length;i++)if(a>=p[i]){r=g[i];break}o(e,t,n,r)});var $={},w=Math.PI,x=6378245,y=.006693421622965943;$.toWGS84=d(function(e,t,n){var o=e[n],i=e[n+1];if(!r(o,i)){var s=a(o,i);o-=s[0],i-=s[1]}t[n]=o,t[n+1]=i}),$.fromWGS84=d(function(e,t,n){var o=e[n],i=e[n+1];if(!r(o,i)){var s=a(o,i);o+=s[0],i+=s[1]}t[n]=o,t[n+1]=i});var M={},w=Math.PI,C=3e3*w/180;M.toWGS84=function(e,t,n){var o=d(l)(e,t,n);return $.toWGS84(o,o,n)},M.fromWGS84=function(e,t,n){var o=$.fromWGS84(e,t,n);return d(c)(o,o,n)};var T={};T.smerc2bmerc=function(e,t,n){var o=u.inverse(e,t,n);return o=M.fromWGS84(o,o,n),h.forward(o,o,n)},T.bmerc2smerc=function(e,t,n){var o=h.inverse(e,t,n);return o=M.toWGS84(o,o,n),u.forward(o,o,n)},T.bmerc2ll=function(e,t,n){var o=h.inverse(e,t,n);return M.toWGS84(o,o,n)},T.ll2bmerc=function(e,t,n){var o=M.fromWGS84(e,t,n);return h.forward(o,o,n)},T.ll2smerc=u.forward,T.smerc2ll=u.inverse;var k=[72.004,.8293,137.8347,55.8271],j=new t.proj.Projection({code:"BD09",extent:t.extent.applyTransform(k,T.ll2bmerc),units:"m"});t.proj.addProjection(j),t.proj.addCoordinateTransforms("EPSG:4326",j,T.ll2bmerc,T.bmerc2ll),t.proj.addCoordinateTransforms("EPSG:3857",j,T.smerc2bmerc,T.bmerc2smerc);for(var S=[],O=0;O<19;O++)S[O]=Math.pow(2,18-O);return new t.source.XYZ({projection:"BD09",maxZoom:18,tileUrlFunction:function(e){var t=e[1],n=e[2],o=e[0];return m.bmapUrl+"/?qt=tile&x="+t+"&y="+n+"&z="+o+"&styles=pl&udt=20151021&scaler=1&p=1"},tileGrid:new t.tilegrid.TileGrid({resolutions:S,origin:[0,0],extent:t.extent.applyTransform(k,T.ll2bmerc),tileSize:[256,256]})})},paramConvert:function(e){var t,n,o,a={};for(o=0;o<e.length;o++)"columns"===(n=e[o].name)&&(t=e[o].value);for(o=0;o<e.length;o++){n=e[o].name;var r=e[o].value;if("string"==typeof r||"number"==typeof r)a[n]=r;else if("order"===n){for(var i=[],s=[],l=0;l<r.length;l++){var c=r[l].column;i.push(t[c].data),s.push(r[l].dir)}a.order=i.join(),a.orderdir=s.join()}}return a},dataConvert:function(e){return{aaData:e.data||[],iTotalDisplayRecords:e.totalCount||0,sEcho:0,iTotalRecords:e.totalCount||0}},paramFilter:function(e,t){var n={};return $.each(e,function(e,o){isArray(o)&&(o=o.join(",")),((t||[]).indexOf(e)>-1||""!==o&&null!==o&&"-1"!==o)&&(n[e]=o)}),n},downloadFile:function(e){if(i.ios)return alert("Your device does not support files downloading. Please try again in desktop browser."),!1;if(i.chrome||i.safari){var t=document.createElement("a");if(t.href=e,void 0!==t.download){var n=e.substring(e.lastIndexOf("/")+1,e.length);t.download=n}if(document.createEvent){var o=document.createEvent("MouseEvents");return o.initEvent("click",!0,!0),t.dispatchEvent(o),!0}}return-1===e.indexOf("?")&&(e+="?download"),location.href=e,!0},debounce:function(e,t,n){var o=null;return function(){clearTimeout(o);var a=arguments;o=setTimeout(function(){e.apply(n,a)},t)}},immediate:function(e,t,n){var o=null,a=!0;return function(){var r=arguments;a&&(e.call(n,r),a=!1),clearTimeout(o),o=setTimeout(function(){a=!0},t)}},throttle:function(e,t,n){var o=!0;return function(){var a=arguments;o&&(e.call(n,a),o=!1,setTimeout(function(){o=!0},t))}}}}();window.$opt=g;var b=function(){$("html").niceScroll({styler:"fb",cursorcolor:"#509fed",cursorwidth:"6",cursorborderradius:"15px",background:"#404040",cursorborder:"",zindex:"9990"}),setTimeout(function(){$("html").css("overflow","")},100),c()},w=function(){var e=function(){$(".slidebar").hasClass("slidebar-2x"),$(".slidebar").hasClass("on")?$(".header-right").css("position","fixed"):$(".header-right").css("position","")};e(),$(".slidebar-switch").on("click",function(){$(".slidebar").toggleClass("on"),e(),$(window).trigger("slidebar")})},x=function(){$("body").on("click",".panel .tools .t-collapse",function(){var e=$(this).parents(".panel").eq(0),t=e.children(".panel-body");$(this).hasClass("fa-chevron-down")?($(this).removeClass("fa-chevron-down").addClass("fa-chevron-up"),e.data("min-height",e.css("min-height")),e.css("min-height",0),t.slideUp(200),t.hide()):($(this).removeClass("fa-chevron-up").addClass("fa-chevron-down"),t.slideDown(200),e.css("min-height",e.data("min-height")),t.show())}),$("body").on("click",".panel .tools .t-close",function(){$(this).parents(".panel").hide()}),$("body").on("click",".box-refresh",function(e){e.preventDefault(),$(this).parents(".tools").parents(".panel-heading").parents(".panel").trigger("refresh")}),$("body").on("loading.show",".panel",function(){var e=$(this);e.find(".refresh-block").remove(),$('<div class="refresh-block"><span class="refresh-loader"><i class="fa fa-spinner fa-spin"></i></span></div>').appendTo(e)}),$("body").on("loading.hide",".panel",function(){$(this).find(".refresh-block").remove()}),$("body").on("click",".pro-list",function(){var e=$(this).parents(".row").eq(0).find(".pro-list-body");0==e.length&&(e=$(this).parents('div[class*="list-slide-"]').eq(0).find(".pro-list-body")),$(this).hasClass("fa-chevron-down")?($(this).removeClass("fa-chevron-down").addClass("fa-chevron-up"),e.slideUp(200)):($(this).removeClass("fa-chevron-up").addClass("fa-chevron-down"),e.slideDown(200))}),$(window).on("resize",function(){$(".panel").trigger("panel:resize")})},y=function(e){var t=e||$("body");$.updateTextFields(),t.find(".input-field select").each(function(){$(this).data("select2")||$(this).select2()}),t.find(".js-switch").switchery({size:"small",color:"#79d4a7",secondaryColor:"#e8e8e8"}),t.find(".tooltips").tooltip(),t.find(".popovers").popover(),$(".perfect-scrollbar").niceScroll({styler:"fb",cursorcolor:"#a6d6fa",cursorwidth:"6",cursorborderradius:"15px",background:"#737373",cursorborder:"",zindex:"9990"})};return{initFirst:function(e){b(),x(),d()},initContent:function(e){w(),y()},disposeContent:function(e){}}});