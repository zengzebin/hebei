!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){var t=e.fn.picker,i=function(t,i){var n=this;this.$element=e(t),this.options=e.extend({},e.fn.picker.defaults,i),this.$accept=this.$element.find(".picker-accept"),this.$cancel=this.$element.find(".picker-cancel"),this.$trigger=this.$element.find(".picker-trigger"),this.$footer=this.$element.find(".picker-footer"),this.$header=this.$element.find(".picker-header"),this.$popup=this.$element.find(".picker-popup"),this.$body=this.$element.find(".picker-body"),this.clickStamp="_",this.isInput=this.$trigger.is("input"),this.$trigger.on("keydown.fu.picker",e.proxy(this.keyComplete,this)),this.$trigger.on("focus.fu.picker",e.proxy(function(t){(void 0===t||e(t.target).is("input[type=text]"))&&e.proxy(this.show(),this)},this)),this.$trigger.on("click.fu.picker",e.proxy(function(t){e(t.target).is("input[type=text]")?e.proxy(this.show(),this):e.proxy(this.toggle(),this)},this)),this.$accept.on("click.fu.picker",e.proxy(this.complete,this,"accepted")),this.$cancel.on("click.fu.picker",function(e){e.preventDefault(),n.complete("cancelled")})},n=function(t){var i=Math.max(document.documentElement.clientHeight,window.innerHeight||0),n=e(document).scrollTop(),c=t.$popup.offset();return c.top+t.$popup.outerHeight(!0)>i+n||c.top<n},c=function(e){e.$popup.css("visibility","hidden"),o(e),n(e)&&(r(e),n(e)&&o(e)),e.$popup.css("visibility","visible")},r=function(e){e.$popup.css("top",-e.$popup.outerHeight(!0)+"px")},o=function(e){e.$popup.css("top",e.$trigger.outerHeight(!0)+"px")};i.prototype={constructor:i,complete:function(e){var t={accepted:"onAccept",cancelled:"onCancel",exited:"onExit"},i=this.options[t[e]],n={contents:this.$body};i?(i(n),this.$element.trigger(e+".fu.picker",n)):(this.$element.trigger(e+".fu.picker",n),this.hide())},keyComplete:function(e){this.isInput&&13===e.keyCode?(this.complete("accepted"),this.$trigger.blur()):27===e.keyCode&&(this.complete("exited"),this.$trigger.blur())},destroy:function(){return this.$element.remove(),e(document).off("click.fu.picker.externalClick."+this.clickStamp),this.$element[0].outerHTML},disable:function(){this.$element.addClass("disabled"),this.$trigger.attr("disabled","disabled")},enable:function(){this.$element.removeClass("disabled"),this.$trigger.removeAttr("disabled")},toggle:function(){this.$element.hasClass("showing")?this.hide():this.show()},hide:function(){this.$element.hasClass("showing")&&(this.$element.removeClass("showing"),e(document).off("click.fu.picker.externalClick."+this.clickStamp),this.$element.trigger("hidden.fu.picker"))},externalClickListener:function(e,t){(!0===t||this.isExternalClick(e))&&this.complete("exited")},isExternalClick:function(t){var i,n,c=this.$element.get(0),r=this.options.externalClickExceptions||[],o=e(t.target);if(t.target===c||o.parents(".picker:first").get(0)===c)return!1;for(i=0,n=r.length;i<n;i++)if(o.is(r[i])||o.parents(r[i]).length>0)return!1;return!0},show:function(){var t;if(t=e(document).find(".picker.showing"),t.length>0){if(t.data("fu.picker")&&t.data("fu.picker").options.explicit)return;t.picker("externalClickListener",{},!0)}this.$element.addClass("showing"),c(this),this.$element.trigger("shown.fu.picker"),this.clickStamp=(new Date).getTime()+(Math.floor(100*Math.random())+1),this.options.explicit||e(document).on("click.fu.picker.externalClick."+this.clickStamp,e.proxy(this.externalClickListener,this))}},e.fn.picker=function(t){var n,c=Array.prototype.slice.call(arguments,1),r=this.each(function(){var r=e(this),o=r.data("fu.picker"),s="object"==typeof t&&t;o||r.data("fu.picker",o=new i(this,s)),"string"==typeof t&&(n=o[t].apply(o,c))});return void 0===n?r:n},e.fn.picker.defaults={onAccept:void 0,onCancel:void 0,onExit:void 0,externalClickExceptions:[],explicit:!1},e.fn.picker.Constructor=i,e.fn.picker.noConflict=function(){return e.fn.picker=t,this},e(document).on("focus.fu.picker.data-api","[data-initialize=picker]",function(t){var i=e(t.target).closest(".picker");i.data("fu.picker")||i.picker(i.data())}),e(function(){e("[data-initialize=picker]").each(function(){var t=e(this);t.data("fu.picker")||t.picker(t.data())})})});